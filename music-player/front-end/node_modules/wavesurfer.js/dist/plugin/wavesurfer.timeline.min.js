/*!
 * wavesurfer.js 2.0.0-beta01 (Tue May 02 2017 19:46:40 GMT+0200 (CEST))
 * https://github.com/katspaugh/wavesurfer.js
 * @license CC-BY-3.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("timeline",[],t):"object"==typeof exports?exports.timeline=t():(e.WaveSurfer=e.WaveSurfer||{},e.WaveSurfer.timeline=t())}(this,function(){return function(e){function t(a){if(r[a])return r[a].exports;var i=r[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="localhost:8080/dist/plugin/",t(t.s=6)}({6:function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=function(){function e(t,r){var i=this;if(a(this,e),this.container="string"==typeof t.container?document.querySelector(t.container):t.container,!this.container)throw new Error("No container for wavesurfer timeline");this.wavesurfer=r,this.util=r.util,this.params=this.util.extend({},{height:20,notchPercentHeight:90,primaryColor:"#000",secondaryColor:"#c0c0c0",primaryFontColor:"#000",secondaryFontColor:"#000",fontFamily:"Arial",fontSize:10,formatTimeCallback:function(e){if(e/60>1){var t=parseInt(e/60,10);return e=parseInt(e%60,10),e=e<10?"0"+e:e,t+":"+e}return e},timeInterval:function(e){return e>=25?1:5*e>=25?5:15*e>=25?15:60},primaryLabelInterval:function(e){return e>=25?10:5*e>=25?6:4},secondaryLabelInterval:function(e){return e>=25?5:2}},t),this.canvases=[],this._onScroll=function(){i.wrapper.scrollLeft=i.drawer.wrapper.scrollLeft},this._onRedraw=function(){return i.render()},this._onReady=function(){i.drawer=r.drawer,i.pixelRatio=r.drawer.params.pixelRatio,i.maxCanvasWidth=r.drawer.maxCanvasWidth||r.drawer.width,i.maxCanvasElementWidth=r.drawer.maxCanvasElementWidth||Math.round(i.maxCanvasWidth/i.pixelRatio),i.createWrapper(),i.render(),r.drawer.wrapper.addEventListener("scroll",i._onScroll),r.on("redraw",i._onRedraw)}}return i(e,null,[{key:"create",value:function(t){return{name:"timeline",deferInit:!(!t||!t.deferInit)&&t.deferInit,params:t,instance:e}}}]),i(e,[{key:"init",value:function(){this.wavesurfer.on("ready",this._onReady),this.wavesurfer.isReady&&this._onReady()}},{key:"destroy",value:function(){this.unAll(),this.wavesurfer.un("redraw",this._onRedraw),this.wavesurfer.un("ready",this._onReady),this.wavesurfer.drawer.wrapper.removeEventListener("scroll",this._onScroll),this.wrapper&&this.wrapper.parentNode&&(this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null)}},{key:"createWrapper",value:function(){var e=this,t=this.wavesurfer.params;this.wrapper=this.container.appendChild(document.createElement("timeline")),this.util.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(t.fillParent||t.scrollParent)&&this.util.style(this.wrapper,{width:"100%",overflowX:"hidden",overflowY:"hidden"}),this._onClick=function(t){t.preventDefault();var r="offsetX"in t?t.offsetX:t.layerX;e.fireEvent("click",r/e.wrapper.scrollWidth||0)},this.wrapper.addEventListener("click",this._onClick)}},{key:"removeOldCanvases",value:function(){for(;this.canvases.length>0;){var e=this.canvases.pop();e.parentElement.removeChild(e)}}},{key:"createCanvases",value:function(){this.removeOldCanvases();var e=Math.round(this.drawer.wrapper.scrollWidth),t=Math.ceil(e/this.maxCanvasElementWidth),r=void 0;for(r=0;r<t;r++){var a=this.wrapper.appendChild(document.createElement("canvas"));this.canvases.push(a),this.util.style(a,{position:"absolute",zIndex:4})}}},{key:"render",value:function(){this.createCanvases(),this.updateCanvasStyle(),this.drawTimeCanvases()}},{key:"updateCanvasStyle",value:function(){var e=this.canvases.length,t=void 0;for(t=0;t<e;t++){var r=this.canvases[t],a=this.maxCanvasElementWidth;t===e-1&&(a=this.drawer.wrapper.scrollWidth-this.maxCanvasElementWidth*(e-1)),r.width=a*this.pixelRatio,r.height=this.params.height*this.pixelRatio,this.util.style(r,{width:a+"px",height:this.params.height+"px",left:t*this.maxCanvasElementWidth+"px"})}}},{key:"drawTimeCanvases",value:function(){var e=(this.wavesurfer.backend,this.wavesurfer.params),t=this.wavesurfer.backend.getDuration(),r=parseInt(t,10)+1,a=e.fillParent&&!e.scrollParent?this.drawer.getWidth():this.drawer.wrapper.scrollWidth*e.pixelRatio,i=a/t,n=this.params.formatTimeCallback,s=function(e){return"function"==typeof e?e(i):e},o=s(this.params.timeInterval),l=s(this.params.primaryLabelInterval),h=s(this.params.secondaryLabelInterval),c=0,u=0;if(!(t<=0)){var p=this.params.height-4,f=this.params.height*(this.params.notchPercentHeight/100)-4,d=this.params.fontSize*e.pixelRatio,v=void 0;for(v=0;v<r/o;v++)v%l==0?(this.setFillStyles(this.params.primaryColor),this.fillRect(c,0,1,p),this.setFonts(d+"px "+this.params.fontFamily),this.setFillStyles(this.params.primaryFontColor),this.fillText(n(u),c+5,p)):v%h==0?(this.setFillStyles(this.params.secondaryColor),this.fillRect(c,0,1,p),this.setFonts(d+"px "+this.params.fontFamily),this.setFillStyles(this.params.secondaryFontColor),this.fillText(n(u),c+5,p)):(this.setFillStyles(this.params.secondaryColor),this.fillRect(c,0,1,f)),u+=o,c+=i*o}}},{key:"setFillStyles",value:function(e){this.canvases.forEach(function(t){t.getContext("2d").fillStyle=e})}},{key:"setFonts",value:function(e){this.canvases.forEach(function(t){t.getContext("2d").font=e})}},{key:"fillRect",value:function(e,t,r,a){var i=this;this.canvases.forEach(function(n,s){var o=s*i.maxCanvasWidth,l={x1:Math.max(e,s*i.maxCanvasWidth),y1:t,x2:Math.min(e+r,s*i.maxCanvasWidth+n.width),y2:t+a};l.x1<l.x2&&n.getContext("2d").fillRect(l.x1-o,l.y1,l.x2-l.x1,l.y2-l.y1)})}},{key:"fillText",value:function(e,t,r){var a=void 0,i=0,n=void 0;for(n in this.canvases){var s=this.canvases[n].getContext("2d"),o=s.canvas.width;if(i>t+a)break;i+o>t&&(a=s.measureText(e).width,s.fillText(e,t-i,r)),i+=o}}}]),e}();t.default=n,e.exports=t.default}})});
//# sourceMappingURL=wavesurfer.timeline.min.js.map